local Ply = game.Players.LocalPlayer
local Mouse = Ply:GetMouse()
local GuiName = "StandGui"
local GuiKeybind = "v"
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local CoreGuiService = game:GetService("CoreGui")
local rs = game:GetService("RunService")
local TextService = game:GetService("TextService")

local Color_1 = Color3.fromRGB(160,160,160)
local Color_2 = Color3.fromRGB(155,155,155)
local Color_3 = Color3.fromRGB(120,120,120)
local Color_4 = Color3.fromRGB(90,90,90)
local Color_5 = Color3.fromRGB(180,180,180)

local RoundBoxes = 10
local TweenTime = .5
local Level = 1

local GlobalTweenInfo = TweenInfo.new(TweenTime)
local AlteredTweenInfo = TweenInfo.new(TweenTime, Enum.EasingStyle.Sine, Enum.EasingDirection.Out)

local IconLibraryID = "rbxassetid://3926305904"
local IconLibraryID2 = "rbxassetid://3926307971"

local MainFont = Enum.Font.Gotham
local TARGET = ""
function gplr(String)
    local strl = String:lower()
    for i,v in pairs(game:FindService("Players"):GetPlayers()) do
        if v.Name:lower():sub(1, #String) == String:lower() or v.DisplayName:lower():sub(1, #String) == String:lower() then
            return v
        end
    end 
end
local function GetXY(GuiObject)
	local X, Y = Mouse.X - GuiObject.AbsolutePosition.X, Mouse.Y - GuiObject.AbsolutePosition.Y
	local MaxX, MaxY = GuiObject.AbsoluteSize.X, GuiObject.AbsoluteSize.Y
	X, Y = math.clamp(X, 0, MaxX), math.clamp(Y, 0, MaxY)
	return X, Y, X/MaxX, Y/MaxY
end

local function TitleIcon(ButtonOrNot)
	local NewTitleIcon = Instance.new(ButtonOrNot and "ImageButton" or "ImageLabel")
	NewTitleIcon.Name = "TitleIcon"
	NewTitleIcon.BackgroundTransparency = 1
	NewTitleIcon.Image = IconLibraryID
	NewTitleIcon.ImageRectOffset = Vector2.new(524, 764)
	NewTitleIcon.ImageRectSize = Vector2.new(36, 36)
	NewTitleIcon.Size = UDim2.new(0,14,0,14)
	NewTitleIcon.Position = UDim2.new(1,-17,0,3)
	NewTitleIcon.Rotation = 180
	NewTitleIcon.ZIndex = Level
	return NewTitleIcon
end

local function TickIcon(ButtonOrNot)
	local NewTickIcon = Instance.new(ButtonOrNot and "ImageButton" or "ImageLabel")
	NewTickIcon.Name = "TickIcon"
	NewTickIcon.BackgroundTransparency = 1
	NewTickIcon.Image = "rbxassetid://3926305904"
	NewTickIcon.ImageRectOffset = Vector2.new(312,4)
	NewTickIcon.ImageRectSize = Vector2.new(24,24)
	NewTickIcon.Size = UDim2.new(1,-6,1,-6)
	NewTickIcon.Position = UDim2.new(0,3,0,3)
	NewTickIcon.ZIndex = Level
	return NewTickIcon
end

local function DropdownIcon(ButtonOrNot)
	local NewDropdownIcon = Instance.new(ButtonOrNot and "ImageButton" or "ImageLabel")
	NewDropdownIcon.Name = "DropdownIcon"
	NewDropdownIcon.BackgroundTransparency = 1
	NewDropdownIcon.Image = IconLibraryID2
	NewDropdownIcon.ImageRectOffset = Vector2.new(324,364)
	NewDropdownIcon.ImageRectSize = Vector2.new(36,36)
	NewDropdownIcon.Size = UDim2.new(0,16,0,16)
	NewDropdownIcon.Position = UDim2.new(1,-18,0,2)
	NewDropdownIcon.ZIndex = Level
	return NewDropdownIcon
end

local function SearchIcon(ButtonOrNot)
	local NewSearchIcon = Instance.new(ButtonOrNot and "ImageButton" or "ImageLabel")
	NewSearchIcon.Name = "SearchIcon"
	NewSearchIcon.BackgroundTransparency = 1
	NewSearchIcon.Image = IconLibraryID
	NewSearchIcon.ImageRectOffset = Vector2.new(964,324)
	NewSearchIcon.ImageRectSize = Vector2.new(36,36)
	NewSearchIcon.Size = UDim2.new(0,16,0,16)
	NewSearchIcon.Position = UDim2.new(0,2,0,2)
	NewSearchIcon.ZIndex = Level
	return NewSearchIcon
end

local function ArrowIcon(Name)
	local NewArrowIcon = Instance.new("ImageLabel")
	NewArrowIcon.Name = Name
	NewArrowIcon.BackgroundTransparency = 1
	NewArrowIcon.Image = IconLibraryID
	NewArrowIcon.ImageRectOffset = Vector2.new(524, 764)
	NewArrowIcon.ImageRectSize = Vector2.new(36, 36)
	NewArrowIcon.Rotation = -90
	NewArrowIcon.Size = UDim2.new(0,14,0.2,14)
	NewArrowIcon.Position = UDim2.new(0,455,0,2)
	NewArrowIcon.ZIndex = Level
	return NewArrowIcon
end

local function RoundBox(CornerRadius, ButtonOrNot)
	local NewRoundBox = Instance.new(ButtonOrNot and "ImageButton" or "ImageLabel")
	NewRoundBox.BackgroundTransparency = 1
	NewRoundBox.Image = "rbxassetid://3570695787"
	NewRoundBox.SliceCenter = Rect.new(100,100,100,100)
	NewRoundBox.SliceScale = math.clamp((CornerRadius or 5) * 0.01, 0.01, 1)
	NewRoundBox.ScaleType = Enum.ScaleType.Slice
	NewRoundBox.ZIndex = Level
	return NewRoundBox
end

local function Frame()
	local NewFrame = Instance.new("Frame")
	NewFrame.BorderSizePixel = 0
	NewFrame.ZIndex = Level
	return NewFrame
end

local function ScrollingFrame()
	local NewScrollingFrame = Instance.new("ScrollingFrame")
	NewScrollingFrame.BackgroundTransparency = 1
	NewScrollingFrame.BorderSizePixel = 0
	NewScrollingFrame.ScrollBarThickness = 0
	NewScrollingFrame.ZIndex = Level
	return NewScrollingFrame
end

local function TextButton(Text, Size)
	local NewTextButton = Instance.new("TextButton")
	NewTextButton.Text = Text
	NewTextButton.AutoButtonColor = false
	NewTextButton.Font = MainFont
	NewTextButton.TextColor3 = Color3.fromRGB(255,255,255)
	NewTextButton.BackgroundTransparency = 1
	NewTextButton.TextSize = Size or 12
	NewTextButton.Size = UDim2.new(1,0,1,0)
	NewTextButton.ZIndex = Level
	return NewTextButton
end

local function TextBox(Text, Size)
	local NewTextBox = Instance.new("TextBox")
	NewTextBox.Text = Text
	NewTextBox.Font = MainFont
	NewTextBox.TextColor3 = Color3.fromRGB(1,1,1)
	NewTextBox.BackgroundTransparency = 1
	NewTextBox.TextSize = Size or 12
	NewTextBox.Size = UDim2.new(1,0,1,0)
	NewTextBox.ZIndex = Level
	return NewTextBox
end

local function TextLabel(Text, Size)
	local NewTextLabel = Instance.new("TextLabel")
	NewTextLabel.Text = Text
	NewTextLabel.Font = MainFont
	NewTextLabel.TextColor3 = Color3.fromRGB(255,255,255)
	NewTextLabel.BackgroundTransparency = 1
	NewTextLabel.TextSize = Size or 12
	NewTextLabel.Size = UDim2.new(1,0,1,0)
	NewTextLabel.ZIndex = Level
	return NewTextLabel
end

local function Tween(GuiObject, Dictionary)
	local TweenBase = TweenService:Create(GuiObject, GlobalTweenInfo, Dictionary)
	TweenBase:Play()
	return TweenBase
end

local function Tween1(GuiObject, Dictionary)
	local TweenBase = TweenService:Create(GuiObject, GlobalTweenInfo, Dictionary)
	TweenBase:Play()
    TweenBase.Completed:wait()
	return TweenBase
end

local UILibrary = {}

function UILibrary.Load(GUITitle)
	local TargetedParent = rs:IsStudio() and Ply:WaitForChild("PlayerGui") or CoreGuiService
	
	local FindOldInstance = TargetedParent:FindFirstChild(GUITitle)
	
	if FindOldInstance then
		FindOldInstance:Destroy()
	end
	
	local NewInstance, ContainerFrame, MainFrame
	
	NewInstance = Instance.new("ScreenGui")
	NewInstance.Name = GUITitle
	NewInstance.Parent = TargetedParent
	
	ContainerFrame = Frame()
	ContainerFrame.Name = "ContainerFrame"
	ContainerFrame.Size = UDim2.new(0,700,0,300)
	ContainerFrame.Position = UDim2.new(0.5,-350,0.5,500)
	ContainerFrame.BackgroundTransparency = 1
	ContainerFrame.Parent = NewInstance
	Tween(ContainerFrame, {Position = UDim2.new(0.5,-350,0.5,-150)})

	Level += 1
	
	MainFrame = RoundBox(RoundBoxes)
	MainFrame.ClipsDescendants = true
	MainFrame.Name = "MainFrame"
	MainFrame.Size = UDim2.new(1,-50,1,-30)
	MainFrame.Position = UDim2.new(0,25,0,15)
	MainFrame.ImageColor3 = Color_3
	MainFrame.Parent = ContainerFrame

	local MenuBar, DisplayFrame, TitleBar
	
	MenuBar = ScrollingFrame()
	MenuBar.Name = "MenuBar"
	MenuBar.BackgroundTransparency = 1
	MenuBar.BackgroundColor3 = Color_4
	MenuBar.Size = UDim2.new(0,150,0,235)
	MenuBar.Position = UDim2.new(0,5,0,30)
	MenuBar.CanvasSize = UDim2.new(0,0,0,0)
	MenuBar.Parent = MainFrame
	
	DisplayFrame = RoundBox(RoundBoxes)
	DisplayFrame.Name = "Display"
	DisplayFrame.ImageColor3 = Color_4
	DisplayFrame.Size = UDim2.new(1,-165,0,235)
	DisplayFrame.Position = UDim2.new(0,160,0,30)
	DisplayFrame.Parent = MainFrame
	
	TitleBar = RoundBox(RoundBoxes)
	TitleBar.Name = "TitleBar"
	TitleBar.ImageColor3 = Color_5
	TitleBar.Size = UDim2.new(1,-10,0,20)
	TitleBar.Position = UDim2.new(0,5,0,5)
	TitleBar.Parent = MainFrame
	
	Level += 1
	
	local MinimiseButton, TitleButton
	local MinimiseToggle = true
	
	MinimiseButton = TitleIcon(true)
	MinimiseButton.Name = "Minimise"
	MinimiseButton.Parent = TitleBar
	
	TitleButton = TextButton(GUITitle, 14)
	TitleButton.Name = "TitleButton"
	TitleButton.Size = UDim2.new(1,-20,1,0)
	TitleButton.Parent = TitleBar
	
	local Closed = true
	if _G.GuiToggle then _G.GuiToggle:Disconnect() end
	_G.GuiToggle = Mouse.KeyDown:connect(function(key)
		if key == GuiKeybind then
			if Closed == true then
				Tween(game.CoreGui[GuiName].ContainerFrame.MainFrame, {Size = UDim2.new(1,-50,0,30)})
				Tween(game.CoreGui[GuiName].ContainerFrame.MainFrame.TitleBar.Minimise, {Rotation = 0})
				Tween1(game.CoreGui[GuiName].ContainerFrame, {Position = UDim2.new(0.5,-350,0.5,500)})
				game.CoreGui[GuiName].Enabled = false
				Closed = false
			else
				Closed = true
				game.CoreGui[GuiName].Enabled = true
				Tween(game.CoreGui[GuiName].ContainerFrame.MainFrame, {Size = UDim2.new(1,-50,1,-30)})
				Tween(game.CoreGui[GuiName].ContainerFrame.MainFrame.TitleBar.Minimise, {Rotation = 180})
				Tween1(game.CoreGui[GuiName].ContainerFrame, {Position = UDim2.new(0.5,-350,0.5,-150)})
			end
		end
	end)

	MinimiseButton.MouseButton1Down:Connect(function()
		MinimiseToggle = not MinimiseToggle
		if not MinimiseToggle then
			Tween(MainFrame, {Size = UDim2.new(1,-50,0,30)})
			Tween(MinimiseButton, {Rotation = 0})
		else
			Tween(MainFrame, {Size = UDim2.new(1,-50,1,-30)})
			Tween(MinimiseButton, {Rotation = 180})
		end
	end)
	
	TitleButton.MouseButton1Down:Connect(function()
		local LastMX, LastMY = Mouse.X, Mouse.Y
		local Move, Kill
		Move = Mouse.Move:Connect(function()
			local NewMX, NewMY = Mouse.X, Mouse.Y
			local DX, DY = NewMX - LastMX, NewMY - LastMY
			ContainerFrame.Position += UDim2.new(0,DX,0,DY)
			LastMX, LastMY = NewMX, NewMY
		end)
		Kill = UserInputService.InputEnded:Connect(function(input)
			if input.UserInputType == Enum.UserInputType.MouseButton1 then
				Move:Disconnect()
				Kill:Disconnect()
			end
		end)
	end)
	
	Level += 1
	
	local MenuListLayout
	
	MenuListLayout = Instance.new("UIListLayout")
	MenuListLayout.SortOrder = Enum.SortOrder.LayoutOrder
	MenuListLayout.Padding = UDim.new(0,5)
	MenuListLayout.Parent = MenuBar
	
	local TabCount = 0
	
	local TabLibrary = {}
	
	function TabLibrary.Page(PageTitle, SearchBarIncluded)
		local SearchBarIncluded = (SearchBarIncluded == nil) and true or SearchBarIncluded
		
		local PageContainer = RoundBox(RoundBoxes)
		PageContainer.Name = PageTitle
		PageContainer.Size = UDim2.new(1,0,0,20)
		PageContainer.LayoutOrder = TabCount
		PageContainer.ImageColor3 = (TabCount == 0) and Color_5 or Color_1
		PageContainer.Parent = MenuBar
		
		local PageButton = TextButton(PageTitle, 14)
		PageButton.Name = PageTitle.."Button"
		PageButton.TextTransparency = (TabCount == 0) and 0 or 0.5
		PageButton.Parent = PageContainer
		
		PageButton.MouseButton1Down:Connect(function()
			spawn(function()
				for _, Button in next, MenuBar:GetChildren() do
					if Button:IsA("GuiObject") then
                        game.CoreGui[GuiName].ContainerFrame.MainFrame.TitleBar.TitleButton.Text = GuiName.." : "..PageTitle
						local IsButton = string.find(Button.Name:lower(), PageContainer.Name:lower())
						local Button2 = Button:FindFirstChild(Button.Name.."Button")
						Tween(Button, {ImageColor3 = IsButton and Color_1 or Color_5})
						Tween(Button2, {TextTransparency = IsButton and 0 or 0.5})
					end
				end
			end)
			spawn(function()
				for _, Display in next, DisplayFrame:GetChildren() do
					if Display:IsA("GuiObject") then
						Display.Visible = string.find(Display.Name:lower(), PageContainer.Name:lower())
					end
				end
			end)
		end)
		
		local DisplayPage = ScrollingFrame()
		DisplayPage.Visible = (TabCount == 0)
		DisplayPage.Name = PageTitle
		DisplayPage.Size = UDim2.new(1,0,1,0)
		DisplayPage.Parent = DisplayFrame
		
		TabCount += 1
		
		local DisplayList = Instance.new("UIListLayout")
		DisplayList.SortOrder = Enum.SortOrder.LayoutOrder
		DisplayList.Padding = UDim.new(0,5)
		DisplayList.Parent = DisplayPage
		
		DisplayList:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
			local Y1 = DisplayList.AbsoluteContentSize.Y
			local Y2 = DisplayPage.AbsoluteWindowSize.Y
			DisplayPage.CanvasSize = UDim2.new(0,0,(Y1/Y2)+0.05,0)
		end)
		
		local DisplayPadding = Instance.new("UIPadding")
		DisplayPadding.PaddingBottom = UDim.new(0,5)
		DisplayPadding.PaddingTop = UDim.new(0,5)
		DisplayPadding.PaddingLeft = UDim.new(0,5)
		DisplayPadding.PaddingRight = UDim.new(0,5)
		DisplayPadding.Parent = DisplayPage
		
		if SearchBarIncluded then
			local SearchBarContainer = RoundBox(RoundBoxes)
			SearchBarContainer.Name = "SearchBar"
			SearchBarContainer.ImageColor3 = Color_1
			SearchBarContainer.Size = UDim2.new(1,0,0,20)
			SearchBarContainer.Parent = DisplayPage
			
			local SearchBox = TextBox("Search...")
			SearchBox.Name = "SearchInput"
			SearchBox.Position = UDim2.new(0,20,0,0)
			SearchBox.Size = UDim2.new(1,-20,1,0)
			SearchBox.TextTransparency = 0.5
			SearchBox.TextXAlignment = Enum.TextXAlignment.Left
			SearchBox.Parent = SearchBarContainer
			
			local SearchIcon = SearchIcon()
			SearchIcon.Parent = SearchBarContainer
			
			SearchBox:GetPropertyChangedSignal("Text"):Connect(function()
				local NewValue = SearchBox.Text
				for _, Element in next, DisplayPage:GetChildren() do
					if Element:IsA("Frame") then
						if string.find(Element.Name:lower(), NewValue:lower()) then
							Element.Visible = true
						else
							Element.Visible = false
						end
					end
				end
			end)
		end		
		local PageLibrary = {}
